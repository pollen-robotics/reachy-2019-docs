<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Create your own virtual scene for Reachy"><meta property="og:title" content="Create your own virtual scene for Reachy"><meta property="og:description" content="Create your own virtual scene for Reachy We've created a simulated version of our Reachy robot where we simulate its behaviour and motors physics. It comes as a Unity package with everything already setup.
This lets you create your own 3D Scene within Unity so you can build your own virtual experimental setup. You can add 3D objects with their physics (a table, objects that can be grasped and moved, etc)."><meta property="og:type" content="article"><meta property="og:url" content="https://pollen-robotics.github.io/reachy-docs/docs/simulation/create-your-own-scene/"><title>Create your own virtual scene for Reachy | Reachy manual</title><link rel=icon href=/reachy-docs/favicon.png type=image/x-icon><link rel=stylesheet href=/reachy-docs/book.min.b7fe34b8a4c4da05b2690b4aacfa71ddce0668cc6da3abb67dd3946844125444.css integrity="sha256-t/40uKTE2gWyaQtKrPpx3c4GaMxto6u2fdOUaEQSVEQ="><script defer src=/reachy-docs/en.search.min.a6fb9ee9e5f2b150794066f7c8d9b8625e2a9b63b51cd504757e2709bcd9ea85.js integrity="sha256-pvue6eXysVB5QGb3yNm4Yl4qm2O1HNUEdX4nCbzZ6oU="></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-92714924-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body><input type=checkbox class=hidden id=menu-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/reachy-docs><span>Reachy manual</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/reachy-docs/docs/getting-started/>Getting Started</a><ul><li><a href=/reachy-docs/docs/getting-started/install-your-robot/>Install your robot</a></li><li><a href=/reachy-docs/docs/getting-started/connect-to-your-robot/>Connect to Your Robot</a></li><li><a href=/reachy-docs/docs/getting-started/check-status/>Check the status of Reachy</a></li><li><a href=/reachy-docs/docs/getting-started/faq/>FAQ</a></li></ul></li><li><a href=/reachy-docs/docs/posts/safety/>Safety First</a></li><li><a href=/reachy-docs/docs/technical-specifications/>Technical Specifications</a><ul><li><a href=/reachy-docs/docs/technical-specifications/arm/>Arm</a></li><li><a href=/reachy-docs/docs/technical-specifications/gripper/>Gripper</a></li><li><a href=/reachy-docs/docs/technical-specifications/head/>Head</a></li><li><a href=/reachy-docs/docs/technical-specifications/torso/>Torso</a></li></ul></li><li><a href=/reachy-docs/docs/program-your-robot/>Program your robot</a><ul><li><a href=/reachy-docs/docs/program-your-robot/instantiate-your-robot/>Instantiate Your Robot</a></li><li><a href=/reachy-docs/docs/program-your-robot/control-the-arm/>Control The Arm</a></li><li><a href=/reachy-docs/docs/program-your-robot/control-the-head/>Control The Head</a></li><li><a href=/reachy-docs/docs/program-your-robot/pick-and-place/>Pick and Place</a></li><li><a href=/reachy-docs/docs/program-your-robot/ai/>AI & Coral TPU</a></li><li><a href=/reachy-docs/docs/program-your-robot/python-api/>Python's API</a></li></ul></li><li><a href=/reachy-docs/docs/tictactoe/>TicTacToe Playground</a><ul><li><a href=/reachy-docs/docs/tictactoe/setup-the-demo/>Setup The Demo</a></li><li><a href=/reachy-docs/docs/tictactoe/playing-with-reachy/>Playing With Reachy</a></li><li><a href=/reachy-docs/docs/tictactoe/train-your-own-detection/>Train Your Own Vision Detection</a></li></ul></li><li><a href=/reachy-docs/docs/simulation/>Reachy simulation</a><ul><li><a href=/reachy-docs/docs/simulation/create-your-own-scene/ class=active>Create your own virtual scene for Reachy</a></li></ul></li><li><span>Appendices</span><ul><li><a href=/reachy-docs/docs/appendices/install-from-scratch-raspberry/>Install from Scratch on a Raspberry-Pi</a></li><li><a href=/reachy-docs/docs/appendices/flash-luos-module/>Flash a Luos module</a></li></ul></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/reachy-docs/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Create your own virtual scene for Reachy</strong>
<label for=toc-control><img src=/reachy-docs/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><input type=checkbox class=hidden id=toc-control><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#create-your-own-virtual-scene-for-reachy>Create your own virtual scene for Reachy</a></li><li><a href=#what-you-need>What you need</a></li><li><a href=#import-reachy-package>Import reachy package</a></li><li><a href=#whats-inside>What's inside?</a></li><li><a href=#play-with-reachy>Play with reachy</a></li></ul></nav></aside></header><article class=markdown><h2 id=create-your-own-virtual-scene-for-reachy>Create your own virtual scene for Reachy</h2><p>We've created a simulated version of our Reachy robot where we simulate its behaviour and motors physics. It comes as a Unity package with everything already setup.</p><p>This lets you create your own 3D Scene within Unity so you can <strong>build your own virtual experimental setup</strong>. You can <strong>add 3D objects with their physics</strong> (a table, objects that can be grasped and moved, etc). You can setup lighting conditions and retrieve what the robot will perceive from its camera. You can also detect collisions, so you <strong>can grasp objects</strong>, or <strong>train the robot to perform some specific moves</strong>. You can even add humans avatar to prototype Human-Robot Interactions.</p><img src=/reachy-docs/img/simu/reachy_standing.PNG alt="reachy waiting" width=600px>
<img src=/reachy-docs/img/simu/dropTheMic.gif alt="Reachy can drag and drop objects" width=600px><h2 id=what-you-need>What you need</h2><p>Unity, editor version 2020.1.0b7 or higher. (<a href=https://unity3d.com/fr/beta/2020.1b>Get it here</a>)
We rely on the new <em>Articulation Body</em> component made for robotics. So it will not work on previous version.</p><p>To leverage more physical accuracy in your robotics simulation make sure to setup a few parameters in your Project Settings:</p><ul><li>lower the <em>Fixed Timestep</em>, to 0.01s for instance (in the <em>Time</em> Tab)</li><li>switch the <em>Solver Type</em> to <em>Temporal Gauss Seidel</em> (in the <em>Physics</em> Tab)</li></ul><h2 id=import-reachy-package>Import reachy package</h2><p>You can get the package asset of the reachy simulation on our GitHub deposit: <a href=https://github.com/pollen-robotics/reachy-unity-package>https://github.com/pollen-robotics/reachy-unity-package</a>.</p><p>The Unity package can be found directly in the release: <a href=https://github.com/pollen-robotics/reachy-unity-package/releases/latest>https://github.com/pollen-robotics/reachy-unity-package/releases/latest</a>.</p><p>To use it, simply open your project and go to &lsquo;Assets&rsquo; &ndash;> Import package &ndash;> custom package and select our package.</p><img src=/reachy-docs/img/simu/import_steps.gif alt="How to import reachy" width=600px><h2 id=whats-inside>What's inside?</h2><p>Our package is mainly composed of 2 prefabs composed of the meshes and materials for Reachy, plus a few scripts to control it.</p><p>The Reachy prefab is our robot and the support prefab is simply the support that keeps the robot upright.
In the scripts folder, the ReachyController contains the function you will use to control Reachy. A JointController script is associated to each part of Reachy. This script lets you drive the motor as you would with the real robot. Gripper also have a <em>force sensor</em> script that retrieves the current force applied on the gripper.</p><p>We also provide IO (only a WebSocket for the moment, but other can be easily implemented) scripts which allow you to communicate with the external world. This can be used to control the virtual robot using the same Python's API that we use for the real robot (see section <a href=../>Simulation</a>). This IO let you send command (i-e move Reachy) from an other application or get the current reachy state (i-e reachy's camera image, motors position, gripper force).</p><h2 id=play-with-reachy>Play with reachy</h2><p>Reachy is composed of static parts, such as the torso, the left and the right shoulder cap, and of mobile parts such as the head (only the antennas can move for the moment) and the arms.</p><p>You can directly make those parts move by setting the variables <em>targetPosition</em> in the motors property of the <em>ReachyController</em> component attached to the Reachy Prefab. Each part of an arm is linked to a parent so moving one part will make the children move with it.</p><img src=/reachy-docs/img/simu/inspector_geafy.gif alt="moving reachy in the inspector view" width=600px><blockquote class="book-hint info">As, we use the Unity Physics engine, make sure you are in <em>Play Mode</em> before trying to move the robot.</blockquote><h1 id=reachy-commands>Reachy commands</h1><p>The <em>ReachyCommand</em> script provides high level function to make reachy move and get his current state:</p><ul><li>HandleCommand(SerializableCommands command): Giving a list of motors names and their target position, it will update the robot movements.</li><li>GetCurrentState(): Get the current state of reachy (composed of the cameras view, and the current position of every motors).</li></ul><p>Those functions are for instance called by the IO when you are remotely controlling the robot.</p><h1 id=handle-collisions>Handle collisions</h1><img src=/reachy-docs/img/simu/flippingTable.gif alt="reachy flipping" width=600px><p>Each motor use the <a href=https://docs.unity3d.com/2020.1/Documentation/ScriptReference/ArticulationBody.html>Articulation Body</a> and <a href=https://docs.unity3d.com/ScriptReference/Collider.html>colider</a> components, they allow Reachy to interact with other physical objects.
According to the Unity Docmentation, &ldquo;a Rigidbody object will be pulled downward by gravity and will react to collisions with incoming objects if the right Collider component is also present&rdquo;.
If you want to add other objects to your Scene and have Reachy interact with them, you need to make sure to attach those two components to them. For instance, you can make reachy flip a table by adding a rigidiBody and a collider to a table GameObject and ask reachy to quickly move his arm bottom-up (when close enough to the table).</p><img src=/reachy-docs/img/simu/collisionHandle.gif alt=handleCollision width=600px><h1 id=articulation-body>Articulation Body</h1><p>Each motor has the component <a href=https://docs.unity3d.com/2020.1/Documentation/ScriptReference/ArticulationBody.html>Articulation Body</a> which represents the characteristics of how a specific part of the arm is supposed to move. All motors in Reachy are revolute joints, and they are controlled using the <a href=https://docs.unity3d.com/2020.1/Documentation/ScriptReference/ArticulationDrive.html>Articulation Drive</a> mechanism.</p><p>We've preset a few parameters to try to match closely the real behavior of Reachy's motor</p><ul><li>The Lower limit and Upper limit define the same minimum and maximum angle of rotation as the real robot.</li><li>The stiffness and damping are PD gains of a PID controller.</li><li>The force limit is the maximum force the joint can apply.</li></ul><p>Those parameters were defined by recording moves on the real robot, measure the real trajectory, the backlash and try to reproduce them on the simulation. Yet, depending on your experimental conditions you may need to tune them to get better results.</p></article><footer class=book-footer><div class="flex justify-between"><div><a class="flex align-center" href=https://github.com/pollen-robotics/reachy-docs/edit/master/content/docs/simulation/create-your-own-scene.md target=_blank rel=noopener><img src=/reachy-docs/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><div class=book-comments></div></footer></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#create-your-own-virtual-scene-for-reachy>Create your own virtual scene for Reachy</a></li><li><a href=#what-you-need>What you need</a></li><li><a href=#import-reachy-package>Import reachy package</a></li><li><a href=#whats-inside>What's inside?</a></li><li><a href=#play-with-reachy>Play with reachy</a></li></ul></nav></aside></main></body></html>